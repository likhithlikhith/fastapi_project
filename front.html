<!DOCTYPE html>
<html>
<head>
<title>Product CRUD Example</title>
<style>
    body { font-family: Arial, sans-serif; margin: 40px;}
    h2 { margin-top: 32px;}
    .product-card { border: 1px solid #ccc; border-radius: 8px; padding: 15px; margin-top: 15px; display: inline-block; width: 300px;}
button{margin: 4px;}
  </style>
</head>
<body>
  <h1>Product Manager</h1>]
  <h2>Add Product</h2>
  <input type="number" id="id" placeholder="ID" required><br>
  <input type="text" id="name" placeholder="Name" required><br>
  <input type="text" id="desc" placeholder="Description" required><br>
  <input type="number" id="price" placeholder="Price" step="0.01" required><br>
  <input type="number" id="quantity" placeholder="Quantity" required><br>
  <button onclick="addProduct()">Add Product</button>
  <div id="msg"></div>
  <h2>All Products</h2>
  <button onclick="getProducts()">Refresh List</button>
  <div id="productsList"></div>
  <h2>Update Product</h2>
  <input type="number" id="upId" placeholder="ID to Update" required><br>
  <input type="text" id="upName" placeholder="New Name"><br>
  <input type="text" id="upDesc" placeholder="New Description"><br>
  <input type="number" id="upPrice" placeholder="New Price" step="0.01"><br>
  <input type="number" id="upQuantity" placeholder="New Quantity"><br>
  <button onclick="updateProduct()">Update Product</button>
  <div id="upMsg"></div>
  <script>
    async function addProduct() {
      const product = {
        id: parseInt(document.getElementById("id").value),
        name: document.getElementById("name").value,
        desc: document.getElementById("desc").value,
        price: parseFloat(document.getElementById("price").value),
        quantity: parseInt(document.getElementById("quantity").value)};
      const res = await fetch("http://localhost:8000/product", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(product)});
      const data = await res.json();
      document.getElementById("msg").innerText = data.message || data.detail || "Error!";
      getProducts();}
    async function getProducts() {
      const res = await fetch("http://localhost:8000/products");
      const products = await res.json();
      const listDiv = document.getElementById("productsList");
      listDiv.innerHTML = "";
      products.forEach(prod => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
          <strong>${prod.name}</strong> <br>
          ID: ${prod.id} <br>
          ${prod.desc} <br>
          Price: $${prod.price} <br>
          Quantity: ${prod.quantity} <br>
          <button onclick="deleteProduct(${prod.id})">Delete</button>
        `;
        listDiv.appendChild(card);
      });}
    async function updateProduct() {
      const id = parseInt(document.getElementById("upId").value);
      const updated = {
        id: id,
        name: document.getElementById("upName").value,
        desc: document.getElementById("upDesc").value,
        price: parseFloat(document.getElementById("upPrice").value),
        quantity: parseInt(document.getElementById("upQuantity").value)
      };
      const res = await fetch(`http://localhost:8000/product/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(updated)
      });
      const data = await res.json();
      document.getElementById("upMsg").innerText = data.message || data.detail || "Error!";
      getProducts();
    }
    async function deleteProduct(id) {
      const res = await fetch(`http://localhost:8000/product/${id}`, { method: "DELETE" });
      const data = await res.json();
      alert(data.message || data.detail || "Error!");
      getProducts();
    }
    window.onload = getProducts;
  </script>
</body>
</html>
